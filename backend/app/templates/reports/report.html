<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Scanctum Security Assessment Report</title>
    <style type="text/css">
      @page {
        size: A4;
        margin: 2cm;
      }
      body {
        font-family: Helvetica, Arial, sans-serif;
        font-size: 10pt;
        color: #2c3e50;
        line-height: 1.4;
      }
      h1 {
        font-size: 20pt;
        color: #1a252f;
        margin: 0 0 10pt 0;
        font-weight: bold;
      }
      h2 {
        font-size: 14pt;
        color: #2980b9;
        border-bottom: 2px solid #2980b9;
        padding-bottom: 4pt;
        margin: 20pt 0 10pt 0;
        font-weight: bold;
      }
      h3 {
        font-size: 11pt;
        color: #2c3e50;
        margin: 12pt 0 6pt 0;
        font-weight: bold;
      }
      h4 {
        font-size: 10pt;
        color: #5d6d7e;
        margin: 10pt 0 4pt 0;
        font-weight: bold;
      }
      p {
        margin: 0 0 8pt 0;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 12pt;
      }
      th,
      td {
        padding: 6pt 8pt;
        text-align: left;
        vertical-align: top;
        border: 1px solid #bdc3c7;
      }
      th {
        background-color: #ecf0f1;
        color: #2c3e50;
        font-weight: bold;
      }
      .cover {
        text-align: center;
        padding-top: 80pt;
        page-break-after: always;
      }
      .cover-line {
        margin-bottom: 12pt;
        font-size: 11pt;
      }
      .cover-title {
        font-size: 28pt;
        font-weight: bold;
        color: #1a252f;
        margin-bottom: 8pt;
      }
      .cover-subtitle {
        font-size: 14pt;
        color: #5d6d7e;
        margin-bottom: 30pt;
      }
      .cover-badge {
        border: 2px solid #c0392b;
        color: #c0392b;
        font-weight: bold;
        padding: 10pt 20pt;
        margin: 50pt auto 0 auto;
        text-align: center;
        font-size: 9pt;
        text-transform: uppercase;
        width: 200pt;
      }
      .summary-table {
        width: 100%;
        margin: 10pt 0 16pt 0;
      }
      .summary-table td {
        text-align: center;
        padding: 12pt 6pt;
        border: 1px solid #bdc3c7;
      }
      .summary-num {
        font-size: 20pt;
        font-weight: bold;
      }
      .summary-label {
        font-size: 8pt;
        text-transform: uppercase;
        margin-top: 4pt;
      }
      .sev-critical {
        background-color: #c0392b;
        color: #fff;
      }
      .sev-high {
        background-color: #e67e22;
        color: #fff;
      }
      .sev-medium {
        background-color: #f39c12;
        color: #1a252f;
      }
      .sev-low {
        background-color: #27ae60;
        color: #fff;
      }
      .sev-info {
        background-color: #3498db;
        color: #fff;
      }
      .finding {
        border: 2px solid #bdc3c7;
        margin-bottom: 24pt;
        page-break-inside: avoid;
        background-color: #ffffff;
      }
      .finding-header {
        background-color: #ecf0f1;
        padding: 10pt 12pt;
        border-bottom: 2px solid #bdc3c7;
        font-weight: bold;
        font-size: 11pt;
      }
      .finding-header-table {
        width: 100%;
        border: none;
      }
      .finding-header-table td {
        border: none;
        padding: 0;
      }
      .finding-severity {
        text-transform: uppercase;
        font-size: 9pt;
        text-align: right;
      }
      .finding-body {
        padding: 10pt;
      }
      .finding-meta {
        width: 100%;
        margin-bottom: 10pt;
      }
      .finding-meta td {
        border: 1px solid #d5d8dc;
        padding: 5pt 8pt;
        font-size: 9pt;
      }
      .finding-meta td:first-child {
        width: 15%;
        font-weight: bold;
        background-color: #f8f9fa;
      }
      .finding-meta td:last-child {
        word-break: break-all;
      }
      .section {
        margin-top: 10pt;
      }
      .section-title {
        font-weight: bold;
        font-size: 9pt;
        color: #5d6d7e;
        text-transform: uppercase;
        margin-bottom: 4pt;
      }
      .evidence {
        background-color: #f4f6f7;
        border: 1px solid #d5d8dc;
        padding: 8pt;
        font-family: "Courier New", Courier, monospace;
        font-size: 8pt;
        margin-top: 6pt;
        margin-bottom: 8pt;
        white-space: pre-wrap;
        word-break: break-all;
        line-height: 1.3;
      }
      .disclaimer {
        border: 1px solid #95a5a6;
        padding: 12pt;
        font-size: 8pt;
        color: #5d6d7e;
        background-color: #f8f9fa;
        margin-top: 16pt;
      }
      .page-break {
        page-break-after: always;
      }
    </style>
  </head>
  <body>
    <!-- Cover Page -->
    <div class="cover">
      <table style="width: 100%; border: none">
        <tr>
          <td style="text-align: center; border: none; padding: 0">
            <div class="cover-title">SCANCTUM</div>
            <div class="cover-subtitle">Security Assessment Report</div>
          </td>
        </tr>
      </table>
      <br /><br /><br />
      <table style="width: 100%; border: none">
        <tr>
          <td style="text-align: center; border: none; padding: 4pt 0">
            <strong>Target:</strong><br />{{ scan.target_url }}
          </td>
        </tr>
        <tr>
          <td style="text-align: center; border: none; padding: 4pt 0">
            <strong>Report Date:</strong><br />{{ generated_at }}
          </td>
        </tr>
        <tr>
          <td style="text-align: center; border: none; padding: 4pt 0">
            <strong>Scan Mode:</strong> {{ scan.scan_mode | capitalize }}
            &nbsp;&bull;&nbsp; <strong>Pages Scanned:</strong> {{
            scan.pages_scanned or 0 }}
          </td>
        </tr>
        <tr>
          <td style="text-align: center; border: none; padding: 4pt 0">
            <strong>Overall Risk:</strong> {{ risk_level }}
          </td>
        </tr>
      </table>
      <br /><br />
      <table style="width: 100%; border: none; margin-top: 40pt">
        <tr>
          <td style="text-align: center; border: none; padding: 10pt">
            <table
              style="width: 200pt; margin: 0 auto; border: 2px solid #c0392b"
            >
              <tr>
                <td
                  style="
                    text-align: center;
                    border: none;
                    padding: 10pt 20pt;
                    color: #c0392b;
                    font-weight: bold;
                    font-size: 9pt;
                    text-transform: uppercase;
                  "
                >
                  CONFIDENTIAL
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </div>

    <div class="page-break"></div>

    <!-- Executive Summary -->
    <h2>1. Executive Summary</h2>
    <p>
      This report presents the results of an automated vulnerability assessment
      performed by Scanctum. A total of
      <strong>{{ total_vulns }}</strong> finding(s) were identified across
      <strong>{{ scan.pages_scanned or 0 }}</strong> page(s). The overall risk
      level for this engagement is <strong>{{ risk_level }}</strong>.
    </p>

    <h3>Severity Distribution</h3>
    <table class="summary-table">
      <tr>
        <td class="sev-critical" style="text-align: center">
          <span class="summary-num">{{ severity_counts.critical }}</span><br />
          <span class="summary-label">Critical</span>
        </td>
        <td class="sev-high" style="text-align: center">
          <span class="summary-num">{{ severity_counts.high }}</span><br />
          <span class="summary-label">High</span>
        </td>
        <td class="sev-medium" style="text-align: center">
          <span class="summary-num">{{ severity_counts.medium }}</span><br />
          <span class="summary-label">Medium</span>
        </td>
        <td class="sev-low" style="text-align: center">
          <span class="summary-num">{{ severity_counts.low }}</span><br />
          <span class="summary-label">Low</span>
        </td>
        <td class="sev-info" style="text-align: center">
          <span class="summary-num">{{ severity_counts.info }}</span><br />
          <span class="summary-label">Info</span>
        </td>
      </tr>
    </table>

    <h3>OWASP Top 10 Overview</h3>
    <table>
      <tr>
        <th>Category</th>
        <th>Description</th>
        <th>Count</th>
      </tr>
      {% for cat, info in owasp_top_10.items() %} {% if owasp_counts.get(cat, 0)
      > 0 %}
      <tr>
        <td><strong>{{ cat }}</strong></td>
        <td>{{ info.name }}</td>
        <td style="text-align: center">{{ owasp_counts.get(cat, 0) }}</td>
      </tr>
      {% endif %} {% endfor %} {% if not owasp_counts or (owasp_counts | length
      == 0) %}
      <tr>
        <td colspan="3" style="text-align: center; color: #7f8c8d">
          No OWASP Top 10 findings in this scan.
        </td>
      </tr>
      {% endif %}
    </table>

    <div class="page-break"></div>

    <!-- Detailed Findings -->
    <h2>2. Detailed Findings</h2>
    {% for vuln in vulnerabilities %}
    <div class="finding">
      <div class="finding-header">
        <table class="finding-header-table">
          <tr>
            <td style="width: 75%">{{ vuln.vuln_type }}</td>
            <td class="finding-severity" style="width: 25%">
              {{ vuln.severity }}
            </td>
          </tr>
        </table>
      </div>
      <div class="finding-body">
        <table class="finding-meta">
          <tr>
            <td>URL</td>
            <td style="font-family: monospace; font-size: 8pt">
              {{ vuln.affected_url }}
            </td>
          </tr>
          <tr>
            <td>CVSS Score</td>
            <td>
              {{ "%.1f" | format(vuln.cvss_score) }} ({{ vuln.owasp_category }}
              / {{ vuln.cwe_id }})
            </td>
          </tr>
          {% if vuln.affected_parameter %}
          <tr>
            <td>Parameter</td>
            <td>{{ vuln.affected_parameter }}</td>
          </tr>
          {% endif %}
        </table>

        <div class="section">
          <div class="section-title">Description</div>
          <p>{{ vuln.description }}</p>
        </div>
        <br />

        {% if vuln.evidence %}
        <div class="section">
          <div class="section-title">Evidence</div>
          {% for ev in vuln.evidence %}
          <div class="evidence">
            <strong>{{ ev.title }}:</strong><br />
            {% set content = (ev.content or '')[:1500] %} {{ content }}{% if
            (ev.content or '') | length > 1500 %}... [truncated - full content
            available in JSON export]{% endif %}
          </div>
          {% endfor %}
        </div>
        <br />
        {% endif %}

        <div class="section">
          <div class="section-title">Remediation</div>
          <p>{{ vuln.remediation }}</p>
        </div>
      </div>
    </div>
    <br />
    {% endfor %} {% if not vulnerabilities %}
    <p style="text-align: center; padding: 30pt; color: #27ae60">
      <strong>No vulnerabilities were identified.</strong>
    </p>
    {% endif %}

    <div class="page-break"></div>

    <!-- Disclaimer -->
    <h2>3. Disclaimer</h2>
    <div class="disclaimer">
      <p>
        This report was generated automatically by Scanctum. Automated tools may
        produce false positives or miss certain vulnerabilities. Findings should
        be validated and interpreted by qualified security personnel.
      </p>
      <p>
        This document is confidential and intended only for the recipient
        organization. Unauthorized distribution is prohibited.
      </p>
    </div>
  </body>
</html>
